{"version":3,"file":"BsDateRange-96efffc0.js","sources":["../../src/components/BsForm/components/BsDateRange.tsx"],"sourcesContent":["/*\n * @Author: 陈宇环\n * @Date: 2022-04-28 15:34:56\n * @LastEditTime: 2023-07-03 15:56:56\n * @LastEditors: 陈宇环\n * @Description: 'yearRange' | 'monthRange' | 'dateRange' | 'datetimeRange'组件\n */\nimport { defineComponent, watch, ref } from 'vue';\nimport dayjs from 'dayjs';\nimport styles from '@/components/BsForm/style.module.scss';\nimport { CustomDynamicComponent } from '@/components/CustomDynamicComponent';\nexport default defineComponent({\n    name: 'BsDateRange',\n    props: {\n        modelValue: {\n            type: [String, Number],\n            default: '',\n        },\n        propEnd: {\n            type: [String, Number],\n            default: '',\n        },\n        config: {\n            type: Object,\n            default() {\n                return {};\n            },\n        },\n    },\n    emits: ['update:modelValue', 'update:propEnd', 'change'],\n    setup(props, { emit }) {\n        const cloneModelValue = ref('');\n        watch(() => props.modelValue, () => {\n            cloneModelValue.value = props.modelValue;\n        }, { immediate: true });\n        // 解决datetime类型，不点击确认按钮无法触发change事件bug\n        watch(() => cloneModelValue.value, () => {\n            updateValue(cloneModelValue.value);\n        });\n        function updateValue(value) {\n            emit('update:modelValue', value);\n            emit('change', {\n                type: 'start',\n                prop: props.config?.prop ?? '',\n                value,\n            });\n        }\n        const clonePropEnd = ref('');\n        watch(() => props.propEnd, () => {\n            clonePropEnd.value = props.propEnd;\n        }, { immediate: true });\n        // 解决datetime类型，不点击确认按钮无法触发change事件bug\n        watch(() => clonePropEnd.value, () => {\n            updateEndValue(clonePropEnd.value);\n        });\n        function updateEndValue(value) {\n            emit('update:propEnd', value);\n            emit('change', {\n                type: 'end',\n                prop: props.config?.propEnd ?? '',\n                value,\n            });\n        }\n        function disabledDate(date) {\n            if (clonePropEnd.value) {\n                // 这里format为了解决element默认08:00:00\n                return +new Date(dayjs(date).format('yyyy-MM-DD HH:mm:ss')) > +new Date(dayjs(clonePropEnd.value).format('yyyy-MM-DD HH:mm:ss'));\n            }\n            return false;\n        }\n        function disabledDateEnd(date) {\n            if (cloneModelValue.value) {\n                return +new Date(dayjs(date).format('yyyy-MM-DD HH:mm:ss')) < +new Date(dayjs(cloneModelValue.value).format('yyyy-MM-DD HH:mm:ss'));\n            }\n            return false;\n        }\n        function removerRange(type) {\n            return type?.replace('Range', '');\n        }\n        function getFormat(type, formatType) {\n            if (removerRange(type) === 'date') {\n                return 'YYYY-MM-DD';\n            }\n            if (removerRange(type) === 'month') {\n                return 'YYYY-MM';\n            }\n            if (removerRange(type) === 'year') {\n                return 'YYYY';\n            }\n            if (removerRange(type) === 'week') {\n                if (formatType === 'format') {\n                    return '第 ww 周';\n                }\n                else {\n                    return null;\n                }\n            }\n            if (removerRange(type) === 'datetime') {\n                return 'YYYY-MM-DD HH:mm:ss';\n            }\n            return 'YYYY-MM-DD';\n        }\n        return () => {\n            const dynamicComponent = new CustomDynamicComponent();\n            const { dynamicDatePicker } = dynamicComponent;\n            // ant-design-vue formitem只允许一个form控件\n            const formItem = CustomDynamicComponent.language === CustomDynamicComponent.antLanguage ? <a-form-item /> : <template />;\n            return <div class={['BsDateRange', styles.width100]} style={{ display: 'flex' }}>\n        <dynamicDatePicker style={{ flex: 1 }} v-model={cloneModelValue.value} class=\"date\" placeholder={props.config.placeholderStart || props.config.placeholder || `请选择${props.config?.label ?? ''}`} disabled={!!props.config.disabled} format={props.config.format || getFormat(props.config.type, 'format')} value-format={props.config.valueFormat || getFormat(props.config.type, 'valueFormat')} disabled-date={props.config.disabledDate || disabledDate} \n            /** ant-design-vue && ele 统一封装 - start */\n            type={removerRange(props.config.type) || 'date'} /** ele 专有属性*/ picker={removerRange(props.config.type) || 'date'} /** ant-design-vue专有属性*/ clearable={props.config.clearable !== false} // ele 特有属性\n             allowClear={props.config.allowClear ?? props.config.clearable !== false} // ant-design-vue特有属性\n             \n            /** ant-design-vue && ele 统一封装 - end */\n            onChange={updateValue} {...props.config.nativeProps}/>\n        <span style=\"padding: 0 5px;\">~</span>\n        <formItem style=\"margin: 0;flex: 1;display: flex;\">\n          <dynamicDatePicker style={{ flex: 1 }} v-model={clonePropEnd.value} class=\"date\" placeholder={props.config.placeholderEnd || props.config.placeholder || `请选择${props.config?.label ?? ''}`} disabled={!!props.config.disabled} format={props.config.format || getFormat(props.config.type, 'format')} value-format={props.config.valueFormat || getFormat(props.config.type, 'valueFormat')} disabled-date={props.config.disabledDate || disabledDateEnd} \n            /** ant-design-vue && ele 统一封装 - start */\n            type={removerRange(props.config.type) || 'date'} /** ele 专有属性*/ picker={removerRange(props.config.type) || 'date'} /** ant-design-vue专有属性*/ clearable={props.config.clearable !== false} // ele 特有属性\n             allowClear={props.config.allowClear ?? props.config.clearable !== false} // ant-design-vue特有属性\n             \n            /** ant-design-vue && ele 统一封装 - end */\n            {...props.config.nativeProps} onChange={updateEndValue}/>\n        </formItem>\n      </div>;\n        };\n    },\n});\nexport * from '../interface/index';\n"],"names":["defineComponent","name","props","modelValue","type","String","Number","default","propEnd","config","Object","_default","emits","setup","_ref","emit","cloneModelValue","ref","watch","value","immediate","updateValue","_props$config$prop","_props$config","prop","clonePropEnd","updateEndValue","_props$config$propEnd","_props$config2","disabledDate","date","Date","dayjs","format","disabledDateEnd","removerRange","replace","getFormat","formatType","_props$config$label","_props$config3","_props$config$allowCl","_props$config$label2","_props$config4","_props$config$allowCl2","dynamicComponent","CustomDynamicComponent","dynamicDatePicker","formItem","language","antLanguage","_createVNode","_resolveComponent","styles","width100","display","_mergeProps","flex","onUpdateModelValue","$event","placeholderStart","placeholder","concat","label","disabled","valueFormat","clearable","allowClear","nativeProps","_createTextVNode","placeholderEnd"],"mappings":"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"}